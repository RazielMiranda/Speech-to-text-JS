<!DOCTYPE html>
<html>
<head>
	<title>RZ Sandbox | Speech</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<img id="img_result" src=""></img>

</head>
<body>

<div id="result"></div>
<script>


window.onload = function(){

	var recognition = new webkitSpeechRecognition();
	recognition.lang = "pt-BR";
	recognition.continuous = true;


	recognition.onresult = function(event){

		var busca = "";

		var busca = event.results[0][0].transcript.trim().toLowerCase();

		if (busca.indexOf("buscar por") > -1) {

			busca = busca.substring(11,busca.length);

			let url = "https://www.google.com/search?q=" + busca;

			window.open(url, "blank");

		}else{

			busca = busca.split(" ").join("+")
			let api_key = "IuFzLL4qAtOzICPwH4CRpTIygyE8y4ms";
			let url = "http://api.giphy.com/v1/gifs/search?q="+busca+"&api_key="+api_key+"&limit=5";
			var xhr = $.get(url);

			xhr.done(function(result){
				console.log(result);
				let qtd = result.data.length;

				if (qtd > 0) {

					let  numero = Math.floor(Math.random() * qtd);
					let image_url = result.data[numero].images.downsized.url;
					 document.getElementById("img_result").src = image_url;

				}

			});

		}

		document.getElementById('result').innerHTML = busca;

	}

	recognition.start();


}
	


</script>
</body>
</html>